## 完整配置文件

`KPlayer`的配置文件顶级中的`play`用于配置播放器、编解码、播放策略相关参数。以下是完整的配置项

```json
{
  "play": {
    "play_model": "list",
    "encode_model": "rtmp",
    "skip_invalid_resource": false,
    "rpc": {
      "on": true,
      "http_port": 4156,
      "grpc_port": 4157,
      "address": "127.0.0.1"
    }
  }
}
```



## 播放模式

`play_model`  可以配置常规的播放模式，例如顺序播放、循环播放、随机播放等模式。

该项需要配置为字符串类型，支持的值有

| 值     | 说明                                                         | 默认值 |
| ------ | ------------------------------------------------------------ | ------ |
| list   | 列表顺序播放                                                 | 是     |
| loop   | 列表顺序播放并且播放完最后一个资源后重新至起始位置循环       | -      |
| random | 随机播放，列表随机播放                                       | -      |
| queue  | 队列模式，该模式下播放完资源列表后不会直接结束将会阻塞等待新的资源加入（通过cli、api添加) | -      |



```json {3}
{
  "play": {
    "play_model": "loop"
  }
}
```



## 编码模式

`encode_model`  可以配置编码模式。`KPlayer`不仅仅支持推流，它也可以作为视频解编码工具使用，可以将预期的视频内容输出到本地文件中。

该项需要配置为字符串类型，支持的值有

| 值   | 说明                                 | 默认值 |
| ---- | ------------------------------------ | ------ |
| rtmp | 推流模式，按照时钟时间戳进行编解码   | 是     |
| file | 文件编码模式，按照帧时间戳进行编解码 | -      |



```json {3}
{
  "play": {
    "encode_model": "rtmp"
  }
}
```



##  跳过无效资源

默认情况下遇到视频格式无效的问题，例如不符合预期的视频文件、非视频文件...`KPlayer默认会抛出错误并结束当前程序。`skip_invalid_resource`配置项允许遇到无效资源时日志打印后不会退出并继续播放下一个资源，直至读取到有效的资源。



| 值    | 说明       | 默认值 |
| ----- | ---------- | ------ |
| true  | 开启该配置 | -      |
| false | 关闭该配置 | 是     |



```json {3}
{
  "play": {
    "skip_invalid_resource": true
  }
}
```



## RPC接口

`KPlayer`提供API接口来运行期间动态控制程序的资源、输出、插件、状态等行为。同事提供`http`与`grpc`服务提供客户端可编程能力来控制播放行为。此处提供基础的API接口配置

访问[这里](#) 查看API如何使用与提供的接口列表。



::: tip 提醒

address 遵循TCP/IP协议对Listen地址的规则要求。

如果需要配置任何地址可以访问该API端口，address需要配置值为：0.0.0.0

:::



| 值        | 子项  | 说明             | 默认值    |
| --------- | ----- | ---------------- | --------- |
| on        | true  | 开启rpc功能      | 是        |
|           | false | 关闭rpc功能      | -         |
| http_port | -     | http服务监听端口 | 4156      |
| grpc_port | -     | grpc服务监听端口 | 4155      |
| address   | -     | 配置监听地址     | 127.0.0.1 |



```json {3-8}
{
  "play": {
    "rpc": {
      "on": true,
      "http_port": 4156,
      "grpc_port": 4157,
      "address": "127.0.0.1"
    }
  }
}
```

